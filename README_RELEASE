	     How to make an emacs-lisp interface release

The best way is to just show you!  Below is a transcript (with
annotations) of me doing it.  I made an official release of this
because a couple of bugs had been found and the 4.2 pre-release is
coming up and I wanted to get a new version number for it.

	Kevin

*******************************************************************************

    sole% 
    sole% echo $FI
    /net/sole/beat/emacs-lib/src/eli
    sole% cd $FI
    sole% cvs diff
    cvs diff: Diffing .
    ===================================================================
    RCS file: /net/vapor/scm/clim/cvs-repository/eli/fi-lemacs.el,v
    retrieving revision 2.13
    diff -r2.13 fi-lemacs.el
    392c392
    <        fi::connection-open]
    ---
    >        (fi::connection-open)]
    . . . more diff output . . .
    cvs diff: Diffing doc
    cvs diff: Diffing examples
    cvs diff: Diffing tools
    1.0u 5.0s 0:14 41%; 0pf, 0sw, 0phy, st 0k, d 0k

Edit the ChangeLog at this point so you can commit:

    sole% cvs commit -m "see changelog for Thu Sep 23 00:10:52 1993"
    cvs commit: Examining .
    cvs commit: Examining doc
    cvs commit: Examining examples
    cvs commit: Examining tools
    cvs commit: Committing .
    Checking in ChangeLog;
    /net/vapor/scm/clim/cvs-repository/eli/ChangeLog,v  <--  ChangeLog
    new revision: 2.44; previous revision: 2.43
    done
    Checking in fi-lemacs.el;
    /net/vapor/scm/clim/cvs-repository/eli/fi-lemacs.el,v  <--  fi-lemacs.el
    new revision: 2.14; previous revision: 2.13
    done
    3.0u 9.0s 0:31 37%; 0pf, 0sw, 0phy, st 0k, d 0k

Make sure everything is up-to-date ("make") and cause this version to
be made available to everyone ("make rdist"):

    sole% make; make rdist
    emacs -nw -batch -q -l fi-version.el -l cl.el -l bytecomp  -l `pwd`/fi-utils -l `pwd`/fi-basic-lep -f batch-byte-compile fi-lemacs.el
    Compiling /net/sole/beat/emacs-lib/src/eli/fi-lemacs.el...
    . . . more compilation output . . .
    Wrote /net/sole/beat/emacs-lib/src/eli/fi-lemacs.elc
    Done
    emacs -nw -batch -q -l fi-test.el
    . . . lots more output . . .
    etags fi-*.el
    rm -fr DIST
    /usr/ucb/rdist -qc Makefile ChangeLog *.doc fi-*.el fi-*.elc \
	    clman.c clman.h clmanaux.c \
	    "`hostname`:`pwd`/DIST"
    (cd DIST;ln -s /net/vapor/scm/emacs-lib/src/eli/clman.data clman.data)
    (cd DIST;ln -s /net/vapor/scm/emacs-lib/src/clman manual)
    (cd DIST; /usr/ucb/rdist -Rc . "{`echo ox akbar clay hyper sole fridge | sed 's/ /,/g'`}:/usr/fi/emacs-lib/fi")
    updating host ox
    removed /usr/fi/emacs-lib/fi/clman.o
    removed /usr/fi/emacs-lib/fi/clmanaux.o
    removed /usr/fi/emacs-lib/fi/clman
    updating: ./ChangeLog
    updating: ./RefCard.doc
    updating: ./RefMan.doc
    updating: ./UserGuide.doc
    updating: ./fi-lemacs.el
    updating: ./fi-lemacs.elc
    updating host akbar
    /usr/fi/emacs-lib/fi: Warning: remote mode 2755 != local mode 755
    removed /usr/fi/emacs-lib/fi/clman.o
    removed /usr/fi/emacs-lib/fi/clmanaux.o
    removed /usr/fi/emacs-lib/fi/clman
    updating: ./ChangeLog
    updating: ./RefCard.doc
    updating: ./RefMan.doc
    updating: ./UserGuide.doc
    updating: ./fi-lemacs.el
    updating: ./fi-lemacs.elc
    updating host clay
    removed /usr/fi/emacs-lib/fi/clman.o
    removed /usr/fi/emacs-lib/fi/clmanaux.o
    removed /usr/fi/emacs-lib/fi/clman
    updating: ./ChangeLog
    updating: ./RefCard.doc
    updating: ./RefMan.doc
    updating: ./UserGuide.doc
    updating: ./fi-lemacs.el
    updating: ./fi-lemacs.elc
    updating host hyper
    updating: ./ChangeLog
    updating: ./RefCard.doc
    updating: ./RefMan.doc
    updating: ./UserGuide.doc
    updating: ./fi-lemacs.el
    updating: ./fi-lemacs.elc
    updating host sole
    removed /usr/fi/emacs-lib/fi/clman.o
    removed /usr/fi/emacs-lib/fi/clmanaux.o
    removed /usr/fi/emacs-lib/fi/clman
    updating: ./ChangeLog
    updating: ./RefCard.doc
    updating: ./RefMan.doc
    updating: ./UserGuide.doc
    updating: ./fi-lemacs.el
    updating: ./fi-lemacs.elc
    updating host fridge
    /usr/fi/emacs-lib/fi: Warning: remote mode 2755 != local mode 755
    removed /usr/fi/emacs-lib/fi/clman.o
    removed /usr/fi/emacs-lib/fi/clmanaux.o
    removed /usr/fi/emacs-lib/fi/clman
    updating: ./ChangeLog
    updating: ./RefCard.doc
    updating: ./RefMan.doc
    updating: ./UserGuide.doc
    updating: ./fi-lemacs.el
    updating: ./fi-lemacs.elc
    for h in ox akbar clay hyper sole fridge; do \
	    echo making clman on $h; \
	    rsh $h "(cd /usr/fi/emacs-lib/fi; make CC=cc clman)"; \
    done
    making clman on ox
    cc -O -c clman.c
    cc -O -c clmanaux.c
    cc -O -o clman clman.o clmanaux.o
    making clman on akbar
    cc -O -c clman.c
    cc -O -c clmanaux.c
    cc -O -o clman clman.o clmanaux.o
    making clman on clay
    cc -O -c clman.c
    cc -O -c clmanaux.c
    cc -O -o clman clman.o clmanaux.o
    making clman on hyper
    cc -O -c clman.c
    clman.h:5: unistd.h: No such file or directory
    *** Exit 1
    Stop.

The above few lines mean that `clman' doesn't work correctly on the
NeXT machines.  I never thought it was worth worrying about (no one
has ever complained).

    making clman on sole
    cc -O -c clman.c
    cc -O -c clmanaux.c
    cc -O -o clman clman.o clmanaux.o
    making clman on fridge
    cc -O -c clman.c
    cc -O -c clmanaux.c
    cc -O -o clman clman.o clmanaux.o
    rm -fr DIST
    13.0u 11.0s 4:02 9%; 0pf, 0sw, 0phy, st 0k, d 0k

The following makes the distribution:

    sole% make fi-dist
    chmod 644 fi-site-init.el ChangeLog
    rm -f version
    emacs -batch -l `pwd`/fi-inc-vers > version
    new emacs-lisp interface version: 2.0.11
    cvs commit -m "`cat version`" fi-site-init.el ChangeLog
    Checking in fi-site-init.el;
    /net/vapor/scm/clim/cvs-repository/eli/fi-site-init.el,v  <--  fi-site-init.el
    new revision: 1.59; previous revision: 1.58
    done
    Checking in ChangeLog;
    /net/vapor/scm/clim/cvs-repository/eli/ChangeLog,v  <--  ChangeLog
    new revision: 2.45; previous revision: 2.44
    done
    mkdir /net/vapor/scm/emacs-lib/Dists/fi-`cat version`
    tar cf - ChangeLog fi-*.el fi-*.elc Makefile *.doc examples/*.el | \
      (cd /net/vapor/scm/emacs-lib/Dists/fi-`cat version`; tar xf -)
    (version=`cat version`; cd /net/vapor/scm/emacs-lib/Dists; \
     tar cf - fi-$version | \
	 gzip -9 > /net/vapor/scm/emacs-lib/Dists/eli-$version.tar.gz)
    (version=`cat version`; cvs tag `echo fi_$version | sed s/\\\\./_/g'`)
    cvs tag: Tagging .
    T ChangeLog
    T fi-indent.el
    T fi-lemacs.el
    T fi-modes.el
    T fi-site-init.el
    cvs tag: Tagging doc
    cvs tag: Tagging examples
    cvs tag: Tagging tools
    14.0u 13.0s 0:57 46%; 0pf, 0sw, 0phy, st 0k, d 0k

Now, cd into the directory where the distribution was put:

    sole% cd /net/vapor/scm/emacs-lib/Dists

and ftp to uunet, with the password for our special maint. account:

    sole% ftp ftp.uu.net
    Connected to ftp.uu.net.
    220 ftp.UU.NET FTP server (Version 2.0WU(13) Fri Apr 9 20:44:32 EDT 1993) ready.
    Name (ftp.uu.net:layer): cas00001
    331 Password required for cas00001.
    Password:taco*met

    230-
    230-                Welcome to the UUNET archive.
    230-   A service of UUNET Technologies Inc, Falls Church, Virginia
    230-   For information about UUNET, call +1 703 204 8000, or see the files
    230-   in /uunet-info
    230-
    230-   Access is allowed all day.  Local time is Thu Sep 23 14:10:03 1993.
    230-
    230-   All transfers are logged with your host name and email address.
    230-   If you don't like this policy, disconnect now!
    230-
    230-   If your FTP client crashes or hangs shortly after login, try using a
    230-   dash (-) as the first character of your password.  This will turn off
    230-   the informational messages which may be confusing your ftp client.
    230-
    230-Please read the file /info/README.ftp
    230-  it was last modified on Mon Jan 18 13:53:56 1993 - 248 days ago
    230-Please read the file /info/README
    230-  it was last modified on Wed Aug  5 21:10:26 1992 - 413 days ago
    230 Guest login ok, access restrictions apply.
    ftp> cd /vendor/franz/emacs
    250 CWD command successful.
    ftp> ls
    200 PORT command successful.
    150 Opening ASCII mode data connection for file list.
    clman-4.1-v2.tar.gz
    clman-4.1-v2-clim2.tar.gz
    README
    eli-2.0.10.tar.gz
    226 Transfer complete.
    75 bytes received in 0.0035 seconds (21 Kbytes/s)
    ftp> binary
    200 Type set to I.
    ftp> put eli-2.0.11.tar.gz
    200 PORT command successful.
    150 Opening BINARY mode data connection for eli-2.0.11.tar.gz.
    226 Transfer complete.
    local: eli-2.0.11.tar.gz remote: eli-2.0.11.tar.gz
    260220 bytes sent in 1.8e+02 seconds (1.4 Kbytes/s)

Before doing the "put README" I edited it to globally change 2.0.10 to
2.0.11:

    ftp> put README
    200 PORT command successful.
    150 Opening BINARY mode data connection for README.
    226 Transfer complete.
    local: README remote: README
    1830 bytes sent in 0.00094 seconds (1.9e+03 Kbytes/s)
    ftp> quit
    221 Goodbye.
    sole% 

You're done!

I usually announce major new versions on allegro-cl@Berkeley.edu.
Sometimes I announce on comp.lang.lisp, which I haven't for the recent
2.0.X distributions.  I think you should.

Look in doc/announce2_0_*.n.  To announce 2.0.11 on comp.lang.lisp you
could just change the version number in the 2.0.9 version.
